<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Middleware Protocol Reference</title>
    <link rel="stylesheet" type="text/css" href="../css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="../css/highlight.css" />
    <meta charset='utf-8'>
    <script src="../js/jquery.min.js" defer></script>
    <script src="../js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a name="//apple_ref/swift/Protocol/Middleware" class="dashAnchor"></a>
    <a title="Middleware Protocol Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="../index.html">SwiftRex 0.7.4 Docs</a> (78% documented)</p>
        <p class="header-right"><a href="https://github.com/SwiftRex/SwiftRex"><img src="../img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="../index.html">SwiftRex Reference</a>
        <img id="carat" src="../img/carat.png" />
        Middleware Protocol Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="../Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../actionenumproperties.html">ActionEnumProperties</a>
              </li>
              <li class="nav-group-task">
                <a href="../combinerex.html">CombineRex</a>
              </li>
              <li class="nav-group-task">
                <a href="../quickguide.html">QuickGuide</a>
              </li>
              <li class="nav-group-task">
                <a href="../reactiveswiftrex.html">ReactiveSwiftRex</a>
              </li>
              <li class="nav-group-task">
                <a href="../rxswiftrex.html">RxSwiftRex</a>
              </li>
              <li class="nav-group-task">
                <a href="../statemanagement.html">StateManagement</a>
              </li>
              <li class="nav-group-task">
                <a href="../swiftrex.html">SwiftRex</a>
              </li>
              <li class="nav-group-task">
                <a href="../uikitlifetimemanagement.html">UIKitLifetimeManagement</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="../Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Classes/ReduxStoreBase.html">ReduxStoreBase</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="../Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Enums/ShouldEmitValue.html">ShouldEmitValue</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="../Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Extensions/Collection.html">Collection</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="../Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Functions.html#/s:8SwiftRex2lgoiyAA12AfterReducerVAD_ADtF">&lt;&gt;(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="../Functions.html#/s:8SwiftRex2lgoiyAA18ComposedMiddlewareVy15InputActionTypeQz06OutputgH0Qz05StateH0QzGx_q_tAA0E0RzAaLR_AEQy_AFRSAGQy_AHRSAIQy_AJRSr0_lF">&lt;&gt;(_:_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="../Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Protocols/ActionHandler.html">ActionHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/Middleware.html">Middleware</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/MiddlewareReaderProtocol.html">MiddlewareReaderProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/Monoid.html">Monoid</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/ReduxStoreProtocol.html">ReduxStoreProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/Semigroup.html">Semigroup</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/StateProvider.html">StateProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/StoreType.html">StoreType</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/SubscriptionCollection.html">SubscriptionCollection</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/SubscriptionType.html">SubscriptionType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="../Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Structs/ActionSource.html">ActionSource</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/AfterReducer.html">AfterReducer</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/AnyActionHandler.html">AnyActionHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/AnyMiddleware.html">AnyMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/AnyStateProvider.html">AnyStateProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/AnyStoreType.html">AnyStoreType</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/ComposedMiddleware.html">ComposedMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/DispatchedAction.html">DispatchedAction</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/ElementIDAction.html">ElementIDAction</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/ElementIndexAction.html">ElementIndexAction</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/IdentityMiddleware.html">IdentityMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/LiftMiddleware.html">LiftMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/MiddlewareReader.html">MiddlewareReader</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/PublisherType.html">PublisherType</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/Reducer.html">Reducer</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/ReduxPipelineWrapper.html">ReduxPipelineWrapper</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/ReplayLastSubjectType.html">ReplayLastSubjectType</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/SubjectType.html">SubjectType</a>
              </li>
              <li class="nav-group-task">
                <a href="../Structs/SubscriberType.html">SubscriberType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="../Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex8GetStatea">GetState</a>
              </li>
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex21MutableReduceFunctiona">MutableReduceFunction</a>
              </li>
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex14ReduceFunctiona">ReduceFunction</a>
              </li>
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex15StoreProjectiona">StoreProjection</a>
              </li>
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex23UnfailablePublisherTypea">UnfailablePublisherType</a>
              </li>
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex31UnfailableReplayLastSubjectTypea">UnfailableReplayLastSubjectType</a>
              </li>
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex17UnfailableSubjecta">UnfailableSubject</a>
              </li>
              <li class="nav-group-task">
                <a href="../Typealiases.html#/s:8SwiftRex24UnfailableSubscriberTypea">UnfailableSubscriberType</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            <h1>Middleware</h1>
              <div class="declaration">
                <div class="language">
                  <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">Middleware</span></code></pre>

                </div>
              </div>
            <p>⛓ <code>Middleware</code> is a plugin, or a composition of several plugins, that are assigned to the <code><a href="../Protocols/ReduxStoreProtocol.html">ReduxStoreProtocol</a></code> pipeline in order to handle each
action received (<code>InputActionType</code>), to execute side-effects in response, and eventually dispatch more actions (<code>OutputActionType</code>) in the process.
This happens before the <code><a href="../Structs/Reducer.html">Reducer</a></code> to do its job.</p>

<p>We can think of a Middleware as an object that transforms actions into sync or async tasks and create more actions as these side-effects complete,
also being able to check the current state at any point.</p>

<p>An action is a lightweight structure, typically an enum, that is dispatched into the <code><a href="../Protocols/ActionHandler.html">ActionHandler</a></code> (usually a <code>StoreProtocol</code>).
A Store like <code><a href="../Protocols/ReduxStoreProtocol.html">ReduxStoreProtocol</a></code> enqueues a new action that arrives and submits it to a pipeline of middlewares. So, in other words, a <code>Middleware</code>
is class that handles actions, and has the power to dispatch more actions to the <code><a href="../Protocols/ActionHandler.html">ActionHandler</a></code> chain. The <code>Middleware</code> can also simply ignore the
action, or it can execute side-effects in response, such as logging into file or over the network, or execute http requests, for example. In case of
those async tasks, when they complete the middleware can dispatch new actions containing a payload with the response (a JSON file, an array of
movies, credentials, etc). Other middlewares will handle that, or maybe even the same middleware in a future RunLoop, or perhaps some <code><a href="../Structs/Reducer.html">Reducer</a></code>, as
reducers pipeline is at the end of every middleware pipeline.</p>

<p>Middlewares can schedule a callback to be executed after the reducer pipeline is done mutating the global state. At that point, the middleware
will have access to the new state, and in case it cached the old state it can compare them, log, audit, perform analytics tracking, telemetry or
state sync with external devices, such as Apple Watches. Remote Debugging over the network is also a great use of a Middleware.</p>

<p>Every action dispatched also comes with its action source, which is the primary dispatcher of that action. Middlewares can access the file, line,
function and additional information about the entity responsible for creating and dispatching that action, which is a very powerful debugging
information that can help developers to trace how the information flows through the app.</p>

<p>Because the <code>Middleware</code> receive all actions and accesses the state of the app at any point, anything can be done from these small and reusable
boxes. For example, the same <code>CoreLocation</code> middleware could be used from an iOS app, its extensions, the Apple Watch extension or even different
apps, as long as they share some sub-state struct.</p>

<p>Some suggestions of middlewares:</p>

<ul>
<li>Run Timers, pooling some external resource or updating some local state at a constant time</li>
<li>Subscribe for <code>CoreData</code>, <code>Realm</code>, <code>Firebase Realtime Database</code> or equivalent database changes</li>
<li>Be a <code>CoreLocation</code> delegate, checking for significant location changes or beacon ranges and triggering actions to update the state</li>
<li>Be a <code>HealthKit</code> delegate to track activities, or even combining that with <code>CoreLocation</code> observation in order to track the activity route</li>
<li>Logger, Telemetry, Auditing, Analytics tracker, Crash report breadcrumbs</li>
<li>Monitoring or debugging tools, like external apps to monitor the state and actions remotely from a different device</li>
<li><code>WatchConnectivity</code> sync, keep iOS and watchOS state in sync</li>
<li>API calls and other &ldquo;cold observables&rdquo;</li>
<li>Network Reachability</li>
<li>Navigation through the app (Redux Coordinator pattern)</li>
<li><code>CoreBluetooth</code> central or peripheral manager</li>
<li><code>CoreNFC</code> manager and delegate</li>
<li><code>NotificationCenter</code> and other delegates</li>
<li>WebSocket, TCP Socket, Multipeer and many other connectivity protocols</li>
<li><code>RxSwift</code> observables, <code>ReactiveSwift</code> signal producers, <code>Combine</code> publishers</li>
<li>Observation of traits changes, device rotation, language/locale, dark mode, dynamic fonts, background/foreground state</li>
<li>Any side-effect, I/O, networking, sensors, third-party libraries that you want to abstract</li>
</ul>
<pre class="highlight swift"><code>                  <span class="err">┌─────┐</span>                                                                                        <span class="err">┌─────┐</span>
                  <span class="err">│</span>     <span class="err">│</span>     <span class="n">handle</span>   <span class="err">┌──────────┐</span> <span class="n">request</span>      <span class="err">┌</span> <span class="err">─</span> <span class="err">─</span> <span class="err">─</span> <span class="err">─</span>  <span class="n">response</span>     <span class="err">┌──────────┐</span> <span class="n">dispatch</span>   <span class="err">│</span>     <span class="err">│</span>
                  <span class="err">│</span>     <span class="err">│</span>   <span class="err">┌─────────▶│</span><span class="kt">Middleware</span><span class="err">├─────────────▶</span> <span class="kt">External</span><span class="err">│─────────────▶│</span><span class="kt">Middleware</span><span class="err">│───────────▶│</span><span class="kt">Store</span><span class="err">│─</span> <span class="err">─</span> <span class="err">▶</span> <span class="o">...</span>
                  <span class="err">│</span>     <span class="err">│</span>   <span class="err">│</span> <span class="kt">Action</span>   <span class="err">│</span> <span class="kt">Pipeline</span> <span class="err">│</span> <span class="n">side</span><span class="o">-</span><span class="n">effects</span> <span class="err">│</span> <span class="kt">World</span>    <span class="n">side</span><span class="o">-</span><span class="n">effects</span> <span class="err">│</span> <span class="n">callback</span> <span class="err">│</span> <span class="kt">New</span> <span class="kt">Action</span> <span class="err">│</span>     <span class="err">│</span>
                  <span class="err">│</span>     <span class="err">│</span>   <span class="err">│</span>          <span class="err">└──────────┘</span>               <span class="err">─</span> <span class="err">─</span> <span class="err">─</span> <span class="err">─</span> <span class="err">┘</span>              <span class="err">└──────────┘</span>            <span class="err">└─────┘</span>
<span class="err">┌──────┐</span> <span class="n">dispatch</span> <span class="err">│</span>     <span class="err">│</span>   <span class="err">│</span>                <span class="err">▲</span>
<span class="err">│</span><span class="kt">Button</span><span class="err">│─────────▶│</span><span class="kt">Store</span><span class="err">│──▶│</span>                <span class="err">└───</span><span class="n">afterReducer</span><span class="err">─────┐</span>                   <span class="err">┌────────┐</span>
<span class="err">└──────┘</span> <span class="kt">Action</span>   <span class="err">│</span>     <span class="err">│</span>   <span class="err">│</span>                                     <span class="err">│</span>                <span class="err">┌─▶│</span> <span class="kt">View</span> <span class="mi">1</span> <span class="err">│</span>
                  <span class="err">│</span>     <span class="err">│</span>   <span class="err">│</span>                                  <span class="err">┌─────┐</span>             <span class="err">│</span>  <span class="err">└────────┘</span>
                  <span class="err">│</span>     <span class="err">│</span>   <span class="err">│</span> <span class="n">reduce</span>   <span class="err">┌──────────┐</span>            <span class="err">│</span>     <span class="err">│</span> <span class="n">onNext</span>      <span class="err">│</span>  <span class="err">┌────────┐</span>
                  <span class="err">│</span>     <span class="err">│</span>   <span class="err">└─────────▶│</span> <span class="kt">Reducer</span>  <span class="err">├───────────▶│</span><span class="kt">Store</span><span class="err">│────────────▶├─▶│</span> <span class="kt">View</span> <span class="mi">2</span> <span class="err">│</span>
                  <span class="err">│</span>     <span class="err">│</span>     <span class="kt">Action</span>   <span class="err">│</span> <span class="kt">Pipeline</span> <span class="err">│</span> <span class="kt">New</span> <span class="n">state</span>  <span class="err">│</span>     <span class="err">│</span> <span class="kt">New</span> <span class="n">state</span>   <span class="err">│</span>  <span class="err">└────────┘</span>
                  <span class="err">└─────┘</span>     <span class="o">+</span>        <span class="err">└──────────┘</span>            <span class="err">└─────┘</span>             <span class="err">│</span>  <span class="err">┌────────┐</span>
                              <span class="kt">State</span>                                                <span class="err">└─▶│</span> <span class="kt">View</span> <span class="mi">3</span> <span class="err">│</span>
                                                                                      <span class="err">└────────┘</span>
</code></pre>

<p>Middleware protocol is generic over 3 associated types:</p>
<h4 id='inputactiontype' class='heading'>InputActionType:</h4>

<p>The Action type that this <code>Middleware</code> knows how to handle, so the store will forward actions of this type to this middleware.
Thanks to optics, this action can be a sub-action lifted to a global action type in order to compose with other middlewares acting on the global action of an app. Please check <code>lift(inputActionMap:outputActionMap:stateMap:)</code> for more details.</p>
<h4 id='outputactiontype' class='heading'>OutputActionType:</h4>

<p>The Action type that this <code>Middleware</code> will eventually trigger back to the store in response of side-effects. This can be the same as <code>InputActionType</code> or different, in case you want to separate your enum in requests and responses.
Thanks to optics, this action can be a sub-action lifted to a global action type in order to compose with other middlewares acting on the global action of an app. Please check <code>lift(inputActionMap:outputActionMap:stateMap:)</code> for more details.</p>
<h4 id='statetype' class='heading'>StateType:</h4>

<p>The State part that this <code>Middleware</code> needs to read in order to make decisions. This middleware will be able to read the most up-to-date <code>StateType</code> from the store at any point in time, but it can never write or make changes to it. In some cases, middleware don&rsquo;t need reading the whole global state, so we can decide to allow only a sub-state, or maybe this middleware doesn&rsquo;t need to read any state, so the <code>StateType</code>can safely be set to <code>Void</code>.
Thanks to lenses, this state can be a sub-state lifted to a global state in order to compose with other middlewares acting on the global state of an app. Please check <code>lift(inputActionMap:outputActionMap:stateMap:)</code> for more details.</p>

<p>When implementing your Middleware, all you have to do is to handle the incoming actions:</p>

<p>When implementing your Middleware, all you have to do is to handle the incoming actions:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">LoggerMiddleware</span><span class="p">:</span> <span class="kt">Middleware</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="kt">InputActionType</span> <span class="o">=</span> <span class="kt">AppGlobalAction</span> <span class="c1">// It wants to receive all possible app actions</span>
    <span class="kd">typealias</span> <span class="kt">OutputActionType</span> <span class="o">=</span> <span class="kt">Never</span>          <span class="c1">// No action is generated from this Middleware</span>
    <span class="kd">typealias</span> <span class="kt">StateType</span> <span class="o">=</span> <span class="kt">AppGlobalState</span>        <span class="c1">// It wants to read the whole app state</span>

    <span class="k">var</span> <span class="nv">getState</span><span class="p">:</span> <span class="kt">GetState</span><span class="o">&lt;</span><span class="kt">AppGlobalState</span><span class="o">&gt;!</span>

    <span class="kd">func</span> <span class="nf">receiveContext</span><span class="p">(</span><span class="nv">getState</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">GetState</span><span class="o">&lt;</span><span class="kt">AppGlobalState</span><span class="o">&gt;</span><span class="p">,</span> <span class="nv">output</span><span class="p">:</span> <span class="kt">AnyActionHandler</span><span class="o">&lt;</span><span class="kt">Never</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">getState</span> <span class="o">=</span> <span class="n">getState</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">handle</span><span class="p">(</span><span class="nv">action</span><span class="p">:</span> <span class="kt">AppGlobalAction</span><span class="p">,</span> <span class="n">from</span> <span class="nv">dispatcher</span><span class="p">:</span> <span class="kt">ActionSource</span><span class="p">,</span> <span class="nv">afterReducer</span><span class="p">:</span> <span class="k">inout</span> <span class="kt">AfterReducer</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stateBefore</span><span class="p">:</span> <span class="kt">AppGlobalState</span> <span class="o">=</span> <span class="nf">getState</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">dateBefore</span> <span class="o">=</span> <span class="kt">Date</span><span class="p">()</span>

        <span class="n">afterReducer</span> <span class="o">=</span> <span class="o">.</span><span class="k">do</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">stateAfter</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">getState</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">dateAfter</span> <span class="o">=</span> <span class="kt">Date</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">source</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">file</span><span class="se">)</span><span class="s">:</span><span class="se">\(</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">line</span><span class="se">)</span><span class="s"> - </span><span class="se">\(</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">function</span><span class="se">)</span><span class="s"> | </span><span class="se">\(</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">info</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s">"</span>

            <span class="kt">Logger</span><span class="o">.</span><span class="nf">log</span><span class="p">(</span><span class="nv">action</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span> <span class="nv">before</span><span class="p">:</span> <span class="n">stateBefore</span><span class="p">,</span> <span class="nv">after</span><span class="p">:</span> <span class="n">stateAfter</span><span class="p">,</span> <span class="nv">dateBefore</span><span class="p">:</span> <span class="n">dateBefore</span><span class="p">,</span> <span class="nv">dateAfter</span><span class="p">:</span> <span class="n">dateAfter</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">FavoritesAPIMiddleware</span><span class="p">:</span> <span class="kt">Middleware</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="kt">InputActionType</span> <span class="o">=</span> <span class="kt">FavoritesAction</span>  <span class="c1">// It wants to receive only actions related to Favorites</span>
    <span class="kd">typealias</span> <span class="kt">OutputActionType</span> <span class="o">=</span> <span class="kt">FavoritesAction</span> <span class="c1">// It wants to also dispatch actions related to Favorites</span>
    <span class="kd">typealias</span> <span class="kt">StateType</span> <span class="o">=</span> <span class="kt">FavoritesModel</span>         <span class="c1">// It wants to read the app state that manages favorites</span>

    <span class="k">var</span> <span class="nv">getState</span><span class="p">:</span> <span class="kt">GetState</span><span class="o">&lt;</span><span class="kt">FavoritesModel</span><span class="o">&gt;!</span>
    <span class="k">var</span> <span class="nv">output</span><span class="p">:</span> <span class="kt">AnyActionHandler</span><span class="o">&lt;</span><span class="kt">FavoritesAction</span><span class="o">&gt;!</span>

    <span class="kd">func</span> <span class="nf">receiveContext</span><span class="p">(</span><span class="nv">getState</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">GetState</span><span class="o">&lt;</span><span class="kt">FavoritesModel</span><span class="o">&gt;</span><span class="p">,</span> <span class="nv">output</span><span class="p">:</span> <span class="kt">AnyActionHandler</span><span class="o">&lt;</span><span class="kt">FavoritesAction</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">getState</span> <span class="o">=</span> <span class="n">getState</span>
        <span class="k">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">handle</span><span class="p">(</span><span class="nv">action</span><span class="p">:</span> <span class="kt">FavoritesAction</span><span class="p">,</span> <span class="n">from</span> <span class="nv">dispatcher</span><span class="p">:</span> <span class="kt">ActionSource</span><span class="p">,</span> <span class="nv">afterReducer</span><span class="p">:</span> <span class="k">inout</span> <span class="kt">AfterReducer</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">toggleFavorite</span><span class="p">(</span><span class="n">movieId</span><span class="p">)</span> <span class="o">=</span> <span class="n">action</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>

        <span class="k">let</span> <span class="nv">favoritesList</span> <span class="o">=</span> <span class="nf">getState</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">makeFavorite</span> <span class="o">=</span> <span class="o">!</span><span class="n">favoritesList</span><span class="o">.</span><span class="nf">contains</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">movieId</span> <span class="p">})</span>

        <span class="kt">API</span><span class="o">.</span><span class="nf">changeFavorite</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">movieId</span><span class="p">,</span> <span class="nv">makeFavorite</span><span class="p">:</span> <span class="n">makeFavorite</span><span class="p">)</span> <span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
            <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="o">.</span><span class="nf">changedFavorite</span><span class="p">(</span><span class="n">movieId</span><span class="p">,</span> <span class="nv">isFavorite</span><span class="p">:</span> <span class="kc">true</span><span class="p">),</span> <span class="nv">info</span><span class="p">:</span> <span class="s">"API.changeFavorite callback"</span><span class="p">)</span>
            <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
                <span class="k">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="o">.</span><span class="nf">changedFavoriteHasFailed</span><span class="p">(</span><span class="n">movieId</span><span class="p">,</span> <span class="nv">isFavorite</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="n">error</span><span class="p">),</span> <span class="nv">info</span><span class="p">:</span> <span class="s">"API.changeFavorite callback"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><img src="https://swiftrex.github.io/SwiftRex/markdown/img/wwdc2019-226-02.jpg" alt="SwiftUI Side-Effects"></p>

          </section>
          <section class="section task-group-section">
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewareP15InputActionTypeQa"></a>
                    <a name="//apple_ref/swift/Alias/InputActionType" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>The Action type that this <code>Middleware</code> knows how to handle, so the store will forward actions of this type to this middleware.
Thanks to optics, this action can be a sub-action lifted to a global action type in order to compose with other middlewares acting on the global
action of an app. Please check <code>lift(inputActionMap:outputActionMap:stateMap:)</code> for more details.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">associatedtype</span> <span class="kt">InputActionType</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewareP16OutputActionTypeQa"></a>
                    <a name="//apple_ref/swift/Alias/OutputActionType" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>The Action type that this <code>Middleware</code> will eventually trigger back to the store in response of side-effects. This can be the same as
<code><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></code> or different, in case you want to separate your enum in requests and responses.
Thanks to optics, this action can be a sub-action lifted to a global action type in order to compose with other middlewares acting on the global
action of an app. Please check <code>lift(inputActionMap:outputActionMap:stateMap:)</code> for more details.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">associatedtype</span> <span class="kt">OutputActionType</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewareP9StateTypeQa"></a>
                    <a name="//apple_ref/swift/Alias/StateType" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>The State part that this <code>Middleware</code> needs to read in order to make decisions. This middleware will be able to read the most up-to-date
<code>StateType</code> from the store at any point in time, but it can never write or make changes to it. In some cases, middleware don&rsquo;t need reading the
whole global state, so we can decide to allow only a sub-state, or maybe this middleware doesn&rsquo;t need to read any state, so the <code>StateType</code>can
safely be set to <code>Void</code>.
Thanks to lenses, this state can be a sub-state lifted to a global state in order to compose with other middlewares acting on the global state
of an app. Please check <code>lift(inputActionMap:outputActionMap:stateMap:)</code> for more details.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">associatedtype</span> <span class="kt">StateType</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewareP14receiveContext8getState6outputy0G4TypeQzyc_AA16AnyActionHandlerVy06OutputkI0QzGtF"></a>
                    <a name="//apple_ref/swift/Method/receiveContext(getState:output:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewareP14receiveContext8getState6outputy0G4TypeQzyc_AA16AnyActionHandlerVy06OutputkI0QzGtF">receiveContext(getState:<wbr>output:<wbr>)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Middleware setup. This function will be called before actions are handled to the middleware, so you can configure your middleware with the given
parameters. You can hold any of them if you plan to read the state or dispatch new actions.
You can initialize and start timers or async tasks in here or in the <code>handle(action:next)</code> function, but never before this function is called,
otherwise the middleware would not yet be running from a store.
Because no actions are delivered to this middleware before the <code>receiveContext(getState:output:)</code> is called, you can safely keep implicit
unwrapped versions of <code>getState</code> and <code>output</code> as properties of your concrete middleware, and set them from the arguments of this function.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">receiveContext</span><span class="p">(</span><span class="nv">getState</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt"><a href="../Typealiases.html#/s:8SwiftRex8GetStatea">GetState</a></span><span class="o">&lt;</span><span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span><span class="o">&gt;</span><span class="p">,</span> <span class="nv">output</span><span class="p">:</span> <span class="kt"><a href="../Structs/AnyActionHandler.html">AnyActionHandler</a></span><span class="o">&lt;</span><span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span><span class="o">&gt;</span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>getState</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a closure that allows the middleware to read the current state at any point in time</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>output</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>an action handler that allows the middleware to dispatch new actions at any point in time</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewareP6handle6action4from12afterReducery15InputActionTypeQz_AA0J6SourceVAA05AfterH0VztF"></a>
                    <a name="//apple_ref/swift/Method/handle(action:from:afterReducer:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewareP6handle6action4from12afterReducery15InputActionTypeQz_AA0J6SourceVAA05AfterH0VztF">handle(action:<wbr>from:<wbr>afterReducer:<wbr>)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Handles the incoming actions and may or not start async tasks, check the latest state at any point or dispatch additional actions.
This is also a good place for analytics, tracking, logging and telemetry. You can schedule tasks to run after the reducer changed the global
state if you want, and/or execute things before the reducer.
This function is only called by the store after the <code><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP14receiveContext8getState6outputy0G4TypeQzyc_AA16AnyActionHandlerVy06OutputkI0QzGtF">receiveContext(getState:output:)</a></code> was called, so if you saved the received context from
there you can safely use it here to get the state or dispatch new actions.
Setting the <code>afterReducer</code> in/out parameter is optional, if you don&rsquo;t set it, it defaults to <code>.doNothing()</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">handle</span><span class="p">(</span><span class="nv">action</span><span class="p">:</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">,</span> <span class="n">from</span> <span class="nv">dispatcher</span><span class="p">:</span> <span class="kt"><a href="../Structs/ActionSource.html">ActionSource</a></span><span class="p">,</span> <span class="nv">afterReducer</span><span class="p">:</span> <span class="k">inout</span> <span class="kt"><a href="../Structs/AfterReducer.html">AfterReducer</a></span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>action</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>the action to be handled</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>dispatcher</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>information about the action source, representing the entity that created and dispatched the action</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>afterReducer</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>it can be set to perform any operation after the reducer has changed the global state. If the function ends before you set
          this in/out parameter, <code>afterReducer</code> will default to <code>.doNothing()</code>.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE010eraseToAnyC0AA0fC0Vy15InputActionTypeQz06OutputhI0Qz05StateI0QzGyF"></a>
                    <a name="//apple_ref/swift/Method/eraseToAnyMiddleware()" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE010eraseToAnyC0AA0fC0Vy15InputActionTypeQz06OutputhI0Qz05StateI0QzGyF">eraseToAnyMiddleware()</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Undocumented</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">eraseToAnyMiddleware</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/AnyMiddleware.html">AnyMiddleware</a></span><span class="o">&lt;</span><span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">,</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span><span class="p">,</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE4lift11inputAction06outputF05stateAA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_qd_0_06OutputfK0Qzc05StateK0Qzqd_1_ctr1_lF"></a>
                    <a name="//apple_ref/swift/Method/lift(inputAction:outputAction:state:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE4lift11inputAction06outputF05stateAA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_qd_0_06OutputfK0Qzc05StateK0Qzqd_1_ctr1_lF">lift(inputAction:<wbr>outputAction:<wbr>state:<wbr>)</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A method used to transform a middleware focused in a specific substate into a middleware that can be plugged in a global scope and composed with
other middlewares that work on different generic parameters. The global state of your app is <em>Whole</em>, and the <code>Middleware</code> handles <em>Part</em>, that
is a sub-state.
So for example you may want to have a <code>GPSMiddleware</code> that knows about the following <code>struct</code>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Location</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span>
   <span class="k">let</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span>
<span class="p">}</span>
</code></pre>

<p>Let&rsquo;s call it <code>Part</code>. Both, this state and its middleware will be part of an external framework, used by dozens of apps. Internally probably the
<code>Middleware</code> will use <code>CoreLocation</code> to fetch the GPS changes, and triggers some actions. On the main app we have a global state, that we now
call <code>Whole</code>.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyGlobalState</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
   <span class="k">let</span> <span class="nv">listOfItems</span><span class="p">:</span> <span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
   <span class="k">let</span> <span class="nv">currentLocation</span><span class="p">:</span> <span class="kt">Location</span>
<span class="p">}</span>
</code></pre>

<p>As expected, <code>Part</code> is a property of <code>Whole</code>, maybe not directly, it could be several nodes deep in the tree.</p>

<p>Because our <code>Store</code> understands <code>Whole</code> and our <code>GPSMiddleware</code> understands <code>Part</code>, we must <code>lift(_:)</code> the middleware to the <code>Whole</code> level, by
using:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">globalStateMiddleware</span> <span class="o">=</span> <span class="n">gpsMiddleware</span><span class="o">.</span><span class="nf">lift</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="err">\</span><span class="kt">MyGlobalState</span><span class="o">.</span><span class="n">currentLocation</span><span class="p">)</span>
</code></pre>

<p>Now this middleware can be used within our <code>Store</code> or even composed with others. It also can be used in other apps as long as we have a way to
lift it to the world of <code>Whole</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="n">lift</span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">inputAction</span> <span class="nv">inputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalInputActionType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">?,</span>
    <span class="n">outputAction</span> <span class="nv">outputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span>
    <span class="n">state</span> <span class="nv">stateMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalStateType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="p">,</span> <span class="k">Self</span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>inputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will be executed every time a global action arrives at the global store. Then you can optionally return an
            action of type Middleware&rsquo;s local input action type so the middleware will handle this action, or you can return nil in case
            you want this middleware to ignore this global action. This is useful because not all middlewares will care about all global
            actions. Usually this is a KeyPath in an enum, such as <code>\GlobalAction.someSubAction?.middlewareLocalAction</code> when you use code
            generators to create enum properties.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>outputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the local actions dispatched by this middleware into a global action type for your store.
             Usually this is wrapping the enum in a global action tree, such as
             <code>{ GlobalAction.someSubAction(.middlewareLocalAction($0)) }</code>.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>stateMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the global state of your store into the local state of this middleware. Usually this is a KeyPath in
      the global state struct, such as <code>\GlobalState.subState.middlewareLocalState</code>.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>a <code><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></code> that knows how to translate <code>Whole</code> to <code>Part</code> and vice-versa. To the external world this resulting middleware will
       &ldquo;speak&rdquo; global types to be plugged into the main Store. Internally it will &ldquo;speak&rdquo; the types of the wrapped middleware.</p>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE4lift12outputAction5stateAA04LiftC0Vyqd__qd_0_qd_1_xGqd_0_06OutputF4TypeQzc_05StateJ0Qzqd_1_ct05InputfJ0QzRsd__r1_lF"></a>
                    <a name="//apple_ref/swift/Method/lift(outputAction:state:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE4lift12outputAction5stateAA04LiftC0Vyqd__qd_0_qd_1_xGqd_0_06OutputF4TypeQzc_05StateJ0Qzqd_1_ct05InputfJ0QzRsd__r1_lF">lift(outputAction:<wbr>state:<wbr>)</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A method used to transform a middleware focused in a specific substate into a middleware that can be plugged in a global scope and composed with
other middlewares that work on different generic parameters. The global state of your app is <em>Whole</em>, and the <code>Middleware</code> handles <em>Part</em>, that
is a sub-state.
So for example you may want to have a <code>GPSMiddleware</code> that knows about the following <code>struct</code>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Location</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span>
   <span class="k">let</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span>
<span class="p">}</span>
</code></pre>

<p>Let&rsquo;s call it <code>Part</code>. Both, this state and its middleware will be part of an external framework, used by dozens of apps. Internally probably the
<code>Middleware</code> will use <code>CoreLocation</code> to fetch the GPS changes, and triggers some actions. On the main app we have a global state, that we now
call <code>Whole</code>.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyGlobalState</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
   <span class="k">let</span> <span class="nv">listOfItems</span><span class="p">:</span> <span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
   <span class="k">let</span> <span class="nv">currentLocation</span><span class="p">:</span> <span class="kt">Location</span>
<span class="p">}</span>
</code></pre>

<p>As expected, <code>Part</code> is a property of <code>Whole</code>, maybe not directly, it could be several nodes deep in the tree.</p>

<p>Because our <code>Store</code> understands <code>Whole</code> and our <code>GPSMiddleware</code> understands <code>Part</code>, we must <code>lift(_:)</code> the middleware to the <code>Whole</code> level, by
using:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">globalStateMiddleware</span> <span class="o">=</span> <span class="n">gpsMiddleware</span><span class="o">.</span><span class="nf">lift</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="err">\</span><span class="kt">MyGlobalState</span><span class="o">.</span><span class="n">currentLocation</span><span class="p">)</span>
</code></pre>

<p>Now this middleware can be used within our <code>Store</code> or even composed with others. It also can be used in other apps as long as we have a way to
lift it to the world of <code>Whole</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="n">lift</span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">outputAction</span> <span class="nv">outputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span>
    <span class="n">state</span> <span class="nv">stateMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalStateType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="p">,</span> <span class="k">Self</span><span class="o">&gt;</span>
<span class="k">where</span> <span class="kt">GlobalInputActionType</span> <span class="o">==</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>outputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the local actions dispatched by this middleware into a global action type for your store.
             Usually this is wrapping the enum in a global action tree, such as
             <code>{ GlobalAction.someSubAction(.middlewareLocalAction($0)) }</code>.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>stateMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the global state of your store into the local state of this middleware. Usually this is a KeyPath in
      the global state struct, such as <code>\GlobalState.subState.middlewareLocalState</code>.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>a <code><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></code> that knows how to translate <code>Whole</code> to <code>Part</code> and vice-versa. To the external world this resulting middleware will
       &ldquo;speak&rdquo; global types to be plugged into the main Store. Internally it will &ldquo;speak&rdquo; the types of the wrapped middleware.</p>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE4lift11inputAction5stateAA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_05StateJ0Qzqd_1_ct06OutputfJ0QzRsd_0_r1_lF"></a>
                    <a name="//apple_ref/swift/Method/lift(inputAction:state:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE4lift11inputAction5stateAA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_05StateJ0Qzqd_1_ct06OutputfJ0QzRsd_0_r1_lF">lift(inputAction:<wbr>state:<wbr>)</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A method used to transform a middleware focused in a specific substate into a middleware that can be plugged in a global scope and composed with
other middlewares that work on different generic parameters. The global state of your app is <em>Whole</em>, and the <code>Middleware</code> handles <em>Part</em>, that
is a sub-state.
So for example you may want to have a <code>GPSMiddleware</code> that knows about the following <code>struct</code>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Location</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span>
   <span class="k">let</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span>
<span class="p">}</span>
</code></pre>

<p>Let&rsquo;s call it <code>Part</code>. Both, this state and its middleware will be part of an external framework, used by dozens of apps. Internally probably the
<code>Middleware</code> will use <code>CoreLocation</code> to fetch the GPS changes, and triggers some actions. On the main app we have a global state, that we now
call <code>Whole</code>.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyGlobalState</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
   <span class="k">let</span> <span class="nv">listOfItems</span><span class="p">:</span> <span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
   <span class="k">let</span> <span class="nv">currentLocation</span><span class="p">:</span> <span class="kt">Location</span>
<span class="p">}</span>
</code></pre>

<p>As expected, <code>Part</code> is a property of <code>Whole</code>, maybe not directly, it could be several nodes deep in the tree.</p>

<p>Because our <code>Store</code> understands <code>Whole</code> and our <code>GPSMiddleware</code> understands <code>Part</code>, we must <code>lift(_:)</code> the middleware to the <code>Whole</code> level, by
using:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">globalStateMiddleware</span> <span class="o">=</span> <span class="n">gpsMiddleware</span><span class="o">.</span><span class="nf">lift</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="err">\</span><span class="kt">MyGlobalState</span><span class="o">.</span><span class="n">currentLocation</span><span class="p">)</span>
</code></pre>

<p>Now this middleware can be used within our <code>Store</code> or even composed with others. It also can be used in other apps as long as we have a way to
lift it to the world of <code>Whole</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="n">lift</span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">inputAction</span> <span class="nv">inputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalInputActionType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">?,</span>
    <span class="n">state</span> <span class="nv">stateMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalStateType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="p">,</span> <span class="k">Self</span><span class="o">&gt;</span>
<span class="k">where</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span> <span class="o">==</span> <span class="kt">GlobalOutputActionType</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>inputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will be executed every time a global action arrives at the global store. Then you can optionally return an
            action of type Middleware&rsquo;s local input action type so the middleware will handle this action, or you can return nil in case
            you want this middleware to ignore this global action. This is useful because not all middlewares will care about all global
            actions. Usually this is a KeyPath in an enum, such as <code>\GlobalAction.someSubAction?.middlewareLocalAction</code> when you use code
            generators to create enum properties.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>stateMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the global state of your store into the local state of this middleware. Usually this is a KeyPath in
      the global state struct, such as <code>\GlobalState.subState.middlewareLocalState</code>.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>a <code><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></code> that knows how to translate <code>Whole</code> to <code>Part</code> and vice-versa. To the external world this resulting middleware will
       &ldquo;speak&rdquo; global types to be plugged into the main Store. Internally it will &ldquo;speak&rdquo; the types of the wrapped middleware.</p>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE4lift11inputAction06outputF0AA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_qd_0_06OutputfJ0Qzct05StateJ0QzRsd_1_r1_lF"></a>
                    <a name="//apple_ref/swift/Method/lift(inputAction:outputAction:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE4lift11inputAction06outputF0AA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_qd_0_06OutputfJ0Qzct05StateJ0QzRsd_1_r1_lF">lift(inputAction:<wbr>outputAction:<wbr>)</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A method used to transform a middleware focused in a specific substate into a middleware that can be plugged in a global scope and composed with
other middlewares that work on different generic parameters. The global state of your app is <em>Whole</em>, and the <code>Middleware</code> handles <em>Part</em>, that
is a sub-state.
So for example you may want to have a <code>GPSMiddleware</code> that knows about the following <code>struct</code>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Location</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span>
   <span class="k">let</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span>
<span class="p">}</span>
</code></pre>

<p>Let&rsquo;s call it <code>Part</code>. Both, this state and its middleware will be part of an external framework, used by dozens of apps. Internally probably the
<code>Middleware</code> will use <code>CoreLocation</code> to fetch the GPS changes, and triggers some actions. On the main app we have a global state, that we now
call <code>Whole</code>.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyGlobalState</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
   <span class="k">let</span> <span class="nv">listOfItems</span><span class="p">:</span> <span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
   <span class="k">let</span> <span class="nv">currentLocation</span><span class="p">:</span> <span class="kt">Location</span>
<span class="p">}</span>
</code></pre>

<p>As expected, <code>Part</code> is a property of <code>Whole</code>, maybe not directly, it could be several nodes deep in the tree.</p>

<p>Because our <code>Store</code> understands <code>Whole</code> and our <code>GPSMiddleware</code> understands <code>Part</code>, we must <code>lift(_:)</code> the middleware to the <code>Whole</code> level, by
using:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">globalStateMiddleware</span> <span class="o">=</span> <span class="n">gpsMiddleware</span><span class="o">.</span><span class="nf">lift</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="err">\</span><span class="kt">MyGlobalState</span><span class="o">.</span><span class="n">currentLocation</span><span class="p">)</span>
</code></pre>

<p>Now this middleware can be used within our <code>Store</code> or even composed with others. It also can be used in other apps as long as we have a way to
lift it to the world of <code>Whole</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="n">lift</span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">inputAction</span> <span class="nv">inputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalInputActionType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">?,</span>
    <span class="n">outputAction</span> <span class="nv">outputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">GlobalOutputActionType</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="p">,</span> <span class="k">Self</span><span class="o">&gt;</span>
<span class="k">where</span> <span class="kt">GlobalStateType</span> <span class="o">==</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>inputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will be executed every time a global action arrives at the global store. Then you can optionally return an
            action of type Middleware&rsquo;s local input action type so the middleware will handle this action, or you can return nil in case
            you want this middleware to ignore this global action. This is useful because not all middlewares will care about all global
            actions. Usually this is a KeyPath in an enum, such as <code>\GlobalAction.someSubAction?.middlewareLocalAction</code> when you use code
            generators to create enum properties.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>outputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the local actions dispatched by this middleware into a global action type for your store.
             Usually this is wrapping the enum in a global action tree, such as
             <code>{ GlobalAction.someSubAction(.middlewareLocalAction($0)) }</code>.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>a <code><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></code> that knows how to translate <code>Whole</code> to <code>Part</code> and vice-versa. To the external world this resulting middleware will
       &ldquo;speak&rdquo; global types to be plugged into the main Store. Internally it will &ldquo;speak&rdquo; the types of the wrapped middleware.</p>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE4lift11inputActionAA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_t06OutputfI0QzRsd_0_05StateI0QzRsd_1_r1_lF"></a>
                    <a name="//apple_ref/swift/Method/lift(inputAction:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE4lift11inputActionAA04LiftC0Vyqd__qd_0_qd_1_xG05InputF4TypeQzSgqd__c_t06OutputfI0QzRsd_0_05StateI0QzRsd_1_r1_lF">lift(inputAction:<wbr>)</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A method used to transform a middleware focused in a specific substate into a middleware that can be plugged in a global scope and composed with
other middlewares that work on different generic parameters. The global state of your app is <em>Whole</em>, and the <code>Middleware</code> handles <em>Part</em>, that
is a sub-state.
So for example you may want to have a <code>GPSMiddleware</code> that knows about the following <code>struct</code>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Location</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span>
   <span class="k">let</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span>
<span class="p">}</span>
</code></pre>

<p>Let&rsquo;s call it <code>Part</code>. Both, this state and its middleware will be part of an external framework, used by dozens of apps. Internally probably the
<code>Middleware</code> will use <code>CoreLocation</code> to fetch the GPS changes, and triggers some actions. On the main app we have a global state, that we now
call <code>Whole</code>.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyGlobalState</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
   <span class="k">let</span> <span class="nv">listOfItems</span><span class="p">:</span> <span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
   <span class="k">let</span> <span class="nv">currentLocation</span><span class="p">:</span> <span class="kt">Location</span>
<span class="p">}</span>
</code></pre>

<p>As expected, <code>Part</code> is a property of <code>Whole</code>, maybe not directly, it could be several nodes deep in the tree.</p>

<p>Because our <code>Store</code> understands <code>Whole</code> and our <code>GPSMiddleware</code> understands <code>Part</code>, we must <code>lift(_:)</code> the middleware to the <code>Whole</code> level, by
using:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">globalStateMiddleware</span> <span class="o">=</span> <span class="n">gpsMiddleware</span><span class="o">.</span><span class="nf">lift</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="err">\</span><span class="kt">MyGlobalState</span><span class="o">.</span><span class="n">currentLocation</span><span class="p">)</span>
</code></pre>

<p>Now this middleware can be used within our <code>Store</code> or even composed with others. It also can be used in other apps as long as we have a way to
lift it to the world of <code>Whole</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="n">lift</span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">inputAction</span> <span class="nv">inputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalInputActionType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">?</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="p">,</span> <span class="k">Self</span><span class="o">&gt;</span>
<span class="k">where</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span> <span class="o">==</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span> <span class="o">==</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>inputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will be executed every time a global action arrives at the global store. Then you can optionally return an
            action of type Middleware&rsquo;s local input action type so the middleware will handle this action, or you can return nil in case
            you want this middleware to ignore this global action. This is useful because not all middlewares will care about all global
            actions. Usually this is a KeyPath in an enum, such as <code>\GlobalAction.someSubAction?.middlewareLocalAction</code> when you use code
            generators to create enum properties.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>a <code><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></code> that knows how to translate <code>Whole</code> to <code>Part</code> and vice-versa. To the external world this resulting middleware will
       &ldquo;speak&rdquo; global types to be plugged into the main Store. Internally it will &ldquo;speak&rdquo; the types of the wrapped middleware.</p>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE4lift12outputActionAA04LiftC0Vyqd__qd_0_qd_1_xGqd_0_06OutputF4TypeQzc_t05InputfI0QzRsd__05StateI0QzRsd_1_r1_lF"></a>
                    <a name="//apple_ref/swift/Method/lift(outputAction:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE4lift12outputActionAA04LiftC0Vyqd__qd_0_qd_1_xGqd_0_06OutputF4TypeQzc_t05InputfI0QzRsd__05StateI0QzRsd_1_r1_lF">lift(outputAction:<wbr>)</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A method used to transform a middleware focused in a specific substate into a middleware that can be plugged in a global scope and composed with
other middlewares that work on different generic parameters. The global state of your app is <em>Whole</em>, and the <code>Middleware</code> handles <em>Part</em>, that
is a sub-state.
So for example you may want to have a <code>GPSMiddleware</code> that knows about the following <code>struct</code>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Location</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span>
   <span class="k">let</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span>
<span class="p">}</span>
</code></pre>

<p>Let&rsquo;s call it <code>Part</code>. Both, this state and its middleware will be part of an external framework, used by dozens of apps. Internally probably the
<code>Middleware</code> will use <code>CoreLocation</code> to fetch the GPS changes, and triggers some actions. On the main app we have a global state, that we now
call <code>Whole</code>.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyGlobalState</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
   <span class="k">let</span> <span class="nv">listOfItems</span><span class="p">:</span> <span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
   <span class="k">let</span> <span class="nv">currentLocation</span><span class="p">:</span> <span class="kt">Location</span>
<span class="p">}</span>
</code></pre>

<p>As expected, <code>Part</code> is a property of <code>Whole</code>, maybe not directly, it could be several nodes deep in the tree.</p>

<p>Because our <code>Store</code> understands <code>Whole</code> and our <code>GPSMiddleware</code> understands <code>Part</code>, we must <code>lift(_:)</code> the middleware to the <code>Whole</code> level, by
using:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">globalStateMiddleware</span> <span class="o">=</span> <span class="n">gpsMiddleware</span><span class="o">.</span><span class="nf">lift</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="err">\</span><span class="kt">MyGlobalState</span><span class="o">.</span><span class="n">currentLocation</span><span class="p">)</span>
</code></pre>

<p>Now this middleware can be used within our <code>Store</code> or even composed with others. It also can be used in other apps as long as we have a way to
lift it to the world of <code>Whole</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="n">lift</span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">outputAction</span> <span class="nv">outputActionMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">GlobalOutputActionType</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="p">,</span> <span class="k">Self</span><span class="o">&gt;</span>
<span class="k">where</span> <span class="kt">GlobalInputActionType</span> <span class="o">==</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">,</span> <span class="kt">GlobalStateType</span> <span class="o">==</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>outputActionMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the local actions dispatched by this middleware into a global action type for your store.
             Usually this is wrapping the enum in a global action tree, such as
             <code>{ GlobalAction.someSubAction(.middlewareLocalAction($0)) }</code>.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>a <code><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></code> that knows how to translate <code>Whole</code> to <code>Part</code> and vice-versa. To the external world this resulting middleware will
       &ldquo;speak&rdquo; global types to be plugged into the main Store. Internally it will &ldquo;speak&rdquo; the types of the wrapped middleware.</p>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex10MiddlewarePAAE4lift5stateAA04LiftC0Vyqd__qd_0_qd_1_xG9StateTypeQzqd_1_c_t011InputActionH0QzRsd__06OutputjH0QzRsd_0_r1_lF"></a>
                    <a name="//apple_ref/swift/Method/lift(state:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex10MiddlewarePAAE4lift5stateAA04LiftC0Vyqd__qd_0_qd_1_xG9StateTypeQzqd_1_c_t011InputActionH0QzRsd__06OutputjH0QzRsd_0_r1_lF">lift(state:<wbr>)</a>
                    </code>
                      <span class="declaration-note">
                        Extension method
                      </span>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A method used to transform a middleware focused in a specific substate into a middleware that can be plugged in a global scope and composed with
other middlewares that work on different generic parameters. The global state of your app is <em>Whole</em>, and the <code>Middleware</code> handles <em>Part</em>, that
is a sub-state.
So for example you may want to have a <code>GPSMiddleware</code> that knows about the following <code>struct</code>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Location</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span>
   <span class="k">let</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span>
<span class="p">}</span>
</code></pre>

<p>Let&rsquo;s call it <code>Part</code>. Both, this state and its middleware will be part of an external framework, used by dozens of apps. Internally probably the
<code>Middleware</code> will use <code>CoreLocation</code> to fetch the GPS changes, and triggers some actions. On the main app we have a global state, that we now
call <code>Whole</code>.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyGlobalState</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
   <span class="k">let</span> <span class="nv">listOfItems</span><span class="p">:</span> <span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
   <span class="k">let</span> <span class="nv">currentLocation</span><span class="p">:</span> <span class="kt">Location</span>
<span class="p">}</span>
</code></pre>

<p>As expected, <code>Part</code> is a property of <code>Whole</code>, maybe not directly, it could be several nodes deep in the tree.</p>

<p>Because our <code>Store</code> understands <code>Whole</code> and our <code>GPSMiddleware</code> understands <code>Part</code>, we must <code>lift(_:)</code> the middleware to the <code>Whole</code> level, by
using:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">globalStateMiddleware</span> <span class="o">=</span> <span class="n">gpsMiddleware</span><span class="o">.</span><span class="nf">lift</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="err">\</span><span class="kt">MyGlobalState</span><span class="o">.</span><span class="n">currentLocation</span><span class="p">)</span>
</code></pre>

<p>Now this middleware can be used within our <code>Store</code> or even composed with others. It also can be used in other apps as long as we have a way to
lift it to the world of <code>Whole</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="n">lift</span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">state</span> <span class="nv">stateMap</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">GlobalStateType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP9StateTypeQa">StateType</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kt"><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></span><span class="o">&lt;</span><span class="kt">GlobalInputActionType</span><span class="p">,</span> <span class="kt">GlobalOutputActionType</span><span class="p">,</span> <span class="kt">GlobalStateType</span><span class="p">,</span> <span class="k">Self</span><span class="o">&gt;</span>
<span class="k">where</span> <span class="kt">GlobalInputActionType</span> <span class="o">==</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP15InputActionTypeQa">InputActionType</a></span><span class="p">,</span> <span class="kt"><a href="../Protocols/Middleware.html#/s:8SwiftRex10MiddlewareP16OutputActionTypeQa">OutputActionType</a></span> <span class="o">==</span> <span class="kt">GlobalOutputActionType</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>stateMap</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>a function that will translate the global state of your store into the local state of this middleware. Usually this is a KeyPath in
      the global state struct, such as <code>\GlobalState.subState.middlewareLocalState</code>.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>a <code><a href="../Structs/LiftMiddleware.html">LiftMiddleware</a></code> that knows how to translate <code>Whole</code> to <code>Part</code> and vice-versa. To the external world this resulting middleware will
       &ldquo;speak&rdquo; global types to be plugged into the main Store. Internally it will &ldquo;speak&rdquo; the types of the wrapped middleware.</p>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="https://github.com/SwiftRex/SwiftRex" target="_blank" rel="external">SwiftRex</a>. All rights reserved. (Last updated: 2020-11-08)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
