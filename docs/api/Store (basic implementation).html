<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Store (basic implementation)  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a name="//apple_ref/swift/Section/Store (basic implementation)" class="dashAnchor"></a>
    <a title="Store (basic implementation)  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">SwiftRex Docs</a> (62% documented)</p>
        <p class="header-right"><a href="https://github.com/SwiftRex/SwiftRex"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">SwiftRex Reference</a>
        <img id="carat" src="img/carat.png" />
        Store (basic implementation)  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Store (contracts).html">Store (contracts)</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Store.html">Store</a>
              </li>
              <li class="nav-group-task">
                <a href="Store (contracts).html#/s:8SwiftRex13EventProtocolP">EventProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Store (contracts).html#/s:8SwiftRex12EventHandlera">EventHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/EventHandler.html">EventHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/StateProvider.html">StateProvider</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Store (basic implementation).html">Store (basic implementation)</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/StoreBase.html">StoreBase</a>
              </li>
              <li class="nav-group-task">
                <a href="Store (basic implementation).html#/s:8SwiftRex13ActionHandlera">ActionHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/ActionHandler.html">ActionHandler</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Reducer.html">Reducer</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/Reducer.html">Reducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Reducer.html#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Middleware (basics).html">Middleware (basics)</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Middleware.html">Middleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BypassMiddleware.html">BypassMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DirectLineMiddleware.html">DirectLineMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ComposedMiddleware.html">ComposedMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Middleware (basics).html#/s:8SwiftRex2lgoiyAA18ComposedMiddlewareCy9StateTypeQzGx_q_tAA0E0RzAaHR_AEQy_AFRSr0_lF">&lt;&gt;(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SubstateMiddleware.html">SubstateMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/AnyMiddleware.html">AnyMiddleware</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Composition helpers.html">Composition helpers</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Monoid.html">Monoid</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Closure type-aliases.html">Closure type-aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex8GetStatea">GetState</a>
              </li>
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex17NextActionHandlera">NextActionHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex16NextEventHandlera">NextEventHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex14ReduceFunctiona">ReduceFunction</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/PipelineMiddleware.html">PipelineMiddleware</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Subscription.html">Subscription</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SubscriptionCollection.html">SubscriptionCollection</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Structs.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/MessageHandler.html">MessageHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/PublisherType.html">PublisherType</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ReplayLastSubjectType.html">ReplayLastSubjectType</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/SubjectType.html">SubjectType</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/SubscriberType.html">SubscriberType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Typealiases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/s:8SwiftRex23UnfailablePublisherTypea">UnfailablePublisherType</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/s:8SwiftRex31UnfailableReplayLastSubjectTypea">UnfailableReplayLastSubjectType</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/s:8SwiftRex17UnfailableSubjecta">UnfailableSubject</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/s:8SwiftRex24UnfailableSubscriberTypea">UnfailableSubscriberType</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            <h1>Store (basic implementation)</h1>
            
          </section>
          <section class="section task-group-section">
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex9StoreBaseC"></a>
                    <a name="//apple_ref/swift/Class/StoreBase" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex9StoreBaseC">StoreBase</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>üè™ <code><a href="Protocols/Store.html">Store</a></code> defines a protocol for the state store of an app. It must have an input and an output:</p>

<ul>
<li>an <code><a href="Store (contracts).html#/s:8SwiftRex12EventHandlera">EventHandler</a></code>: that&rsquo;s the store input, so it&rsquo;s able to receive and distribute events of type <code><a href="Store (contracts).html#/s:8SwiftRex13EventProtocolP">EventProtocol</a></code>. Being an event handler means that an <code>UIViewController</code> can dispatch events to it, such as <code>.userTappedButtonX</code>, <code>.didScrollToPosition(_:)</code>, <code>.viewDidLoad</code> or <code>queryTextFieldChangedTo(_:)</code>.</li>
<li>a <code><a href="Protocols/StateProvider.html">StateProvider</a></code>: that&rsquo;s the store output, so the system can subscribe a store for updates on State. Being a state provider basically means that store is an Observable<T>, where T is the State of your app, so an <code>UIViewController</code> can subscribe to state changes and react to them.</li>
</ul>

<p>The store will glue all the parts together and its responsibility is being a proxy to the non-Redux world. For that reason, it&rsquo;s correct to say that a <code><a href="Protocols/Store.html">Store</a></code> is the single point of contact with <code>UIKit</code> and it&rsquo;s a class that you want to inject as a dependency on all the ViewControllers, either as one single dependency or, preferably, a dependency for each of its protocols - <code><a href="Store (contracts).html#/s:8SwiftRex12EventHandlera">EventHandler</a></code> and <code><a href="Protocols/StateProvider.html">StateProvider</a></code> -, both eventually pointing to the same instance.</p>

<p><img src="https://swiftrex.github.io/SwiftRex/markdown/img/StoreBase.png" alt="Store and ViewController"></p>

<p>In its documentation, Apple suggests some communication patterns between the MVC layers. Most important, they say that Controllers should update the Model, who notifies the Controller about changes:</p>

<p><img src="https://swiftrex.github.io/SwiftRex/markdown/img/CocoaMVC.gif" alt="iOS MVC"></p>

<p>You can think of Store as a very heavy <q>Model</q> layer, completely detached from the View and Controller, and where all the business logic stands. At a first sight it may look like transfering the <q>Massive</q> problem from a layer to another, but later in this docs it&rsquo;s gonna be clear how the logic will be split and, hopefully, by having specialized middlewares we can even start sharing more code between different apps or different devices such as Apple TV, macOS, iOS, watchOS or backend APIs, thanks to the business decisions being completely off your presentation layer.</p>

<p>You want only one Store in your app, so either you create a singleton or a public property in a long-life class such as AppDelegate or AppCoordinator. That&rsquo;s crucial for making the store completely detached from the <code>UIKit</code> world. Theoretically it should be possible to keep multiple stores - one per module or per <code>UIViewController</code> - and keep them in sync through Rx observation, like the <q>Flux</q> approach. However, the main goal of SwiftRex is to keep an unified state independent from <code>UIKit</code>, therefore it&rsquo;s the recommended approach.</p>

<p>The <code>StoreBase</code> implementation also is:</p>

<ul>
<li>an <code><a href="Store (basic implementation).html#/s:8SwiftRex13ActionHandlera">ActionHandler</a></code>: be able to receive and distribute actions of type <code><a href="Reducer.html#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a></code></li>
</ul>

<p>A <code>StoreBase</code> uses <code><a href="Protocols/Middleware.html">Middleware</a></code> pipeline and <code><a href="Structs/Reducer.html">Reducer</a></code> pipeline. It creates a queue of incoming events that is handled to the middleware pipeline, which triggers actions back to the store. These actions are put in a queue that again are handled to the middleware pipeline, usually for logging or analytics purposes. The actions are them forwarded to the <code><a href="Structs/Reducer.html">Reducer</a></code> pipeline, together with the current state. One by one, the reducers will handle the action and incrementally change a copy of the app state. When this process is done, the store takes the resulting state, sets it as the current state and notifies all subscribers.</p>

<p><img src="https://swiftrex.github.io/SwiftRex/markdown/img/StoreInternals.png" alt="Store internals"></p>

                        <a href="Classes/StoreBase.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">open</span> <span class="kd">class</span> <span class="kt">StoreBase</span><span class="o">&lt;</span><span class="kt">State</span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex13ActionHandlera"></a>
                    <a name="//apple_ref/swift/Alias/ActionHandler" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex13ActionHandlera">ActionHandler</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p><code>ActionHandler</code> is a data structure that wraps a closuse which represents a way to trigger actions - defined by the type <code><a href="Reducer.html#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a></code>. The entity responsible for receiving and distributing these actions (usually the Store) will offer this closure to the entities that want to trigger new actions (usually the Middlewares).</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">ActionHandler</span> <span class="o">=</span> <span class="kt"><a href="Other Typealiases.html#/s:8SwiftRex24UnfailableSubscriberTypea">UnfailableSubscriberType</a></span><span class="o">&lt;</span><span class="kt"><a href="Reducer.html#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a></span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex13ActionHandlera"></a>
                    <a name="//apple_ref/swift/Extension/ActionHandler" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex13ActionHandlera">ActionHandler</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        
                        <a href="Extensions/ActionHandler.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt"><a href="Store (basic implementation).html#/s:8SwiftRex13ActionHandlera">ActionHandler</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="https://github.com/SwiftRex/SwiftRex" target="_blank" rel="external">SwiftRex</a>. All rights reserved. (Last updated: 2019-07-27)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ‚ô™‚ô´ v0.10.0</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
